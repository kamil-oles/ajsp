<div class="rates-table-container" ng-show="$ctrl.data" ng-cloak>
  <table class="rates-table">
    <thead>
      <tr class="rates-table-row">
        <th class="app-typography-body-2-th rates-table-header"
          ng-class="{'rates-table-hide': header.code === 'currency'}" ng-repeat="header in $ctrl.tableData.headers"
          ng-click="$ctrl.sort(header.code)">
          <app-rates-table-header header="header" sort-by="$ctrl.sortBy" sort-direction="$ctrl.sortDirection">
          </app-rates-table-header>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr class="app-typography-body-2 rates-table-row" ng-init="i = $index"
        ng-repeat-start="row in $ctrl.data track by $index">
        <td class="rates-table-data" ng-class="{'rates-table-hide': key === 'currency'}"
          ng-repeat="(key, value) in row">
          <div ng-switch="key"
            ng-class="{'rates-table-left': key === 'date', 'rates-table-right': key === 'ask' || key === 'bid'}">
            <div ng-switch-when="code">
              <span class="rates-table-code">
                {{value}}
              </span>
              <button class="rates-table-code-button" ng-click="$ctrl.expandSubrow(i)" layout
                layout-align="start center">
                {{value}}
                <md-icon class="rates-table-icon" ng-class="{'rates-table-subrow-expanded': $ctrl.subrow === i}">
                  keyboard_arrow_right
                </md-icon>
              </button>
            </div>
            <span ng-switch-when="date">
              {{value | date: "dd.MM.yyyy"}}
            </span>
            <span ng-switch-default>
              {{value}}
            </span>
          </div>
        </td>
      </tr>
      <tr class="app-typography-body-2 rates-table-subrow" ng-repeat-end>
        <td class="rates-table-nested-cell" colspan="3" ng-show="$ctrl.subrow === i">
          <span class="rates-table-nested-data" ng-show="$ctrl.subrow === i">
            {{row["currency"]}}
          </span>
        </td>
      </tr>
    </tbody>
  </table>
</div>